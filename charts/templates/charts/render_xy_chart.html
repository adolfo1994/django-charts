{% load chart_tags %}
<script src="{{MEDIA_URL}}charts/amcharts/amcharts.js" type="text/javascript">
</script>
<script src="{{MEDIA_URL}}charts/amcharts/raphael.js" type="text/javascript">
</script>
        <script type="text/javascript">
		{% with chart.get_queryset as queryset %}
        
            var chart;
		    
	        var chartData = [{
            {% for obj in queryset %}
                {% xy_chart_obj_info chart obj forloop.counter %}
                {% if not forloop.last %},{% endif %}
            {% endfor %}
            }];

            AmCharts.ready(function () {
                // XY Chart
                chart = new AmCharts.AmXYChart();
                chart.pathToImages = "{{MEDIA_URL}}charts/amcharts/images/";
                chart.dataProvider = chartData;
                chart.startDuration = {{chart.start_duration}};
				chart.fontFamily = "{{chart.font_family}}";
				

                // AXES				
                // X
                var xAxis = new AmCharts.ValueAxis();
                xAxis.title = "{{chart.XAxis.title}}";
                xAxis.position = "{{chart.XAxis.position}}";
                xAxis.autoGridCount = {{chart.XAxis.auto_grid_count|yesno:'true,false'}};
                chart.addValueAxis(xAxis);

                // Y
                var yAxis = new AmCharts.ValueAxis();
                yAxis.title = "{{chart.YAxis.title}}";
                yAxis.position = "{{chart.YAxis.position}}";
                yAxis.autoGridCount = {{chart.YAxis.auto_grid_count|yesno:'true,false'}};
                chart.addValueAxis(yAxis);
                
                // ZEICHNET DIE BULLETS
                {% with chart.get_selected as selected_obj %}
                {% for obj in queryset %}
                    {% ifequal obj selected_obj %}
                        {% xy_chart_bullet_info chart obj forloop.counter 1 %}
                    {% else %}
                        {% xy_chart_bullet_info chart obj forloop.counter %}
                    {% endifequal %}
                {% endfor %}
                {% endwith %}

                // WRITE
                chart.write("chartdiv");
            });
        {% endwith %}
        </script>
    
    <div id="chartdiv" style="width:{{chart.width}}px; height:{{chart.height}}px;"></div>

